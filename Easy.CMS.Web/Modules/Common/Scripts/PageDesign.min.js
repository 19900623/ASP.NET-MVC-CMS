$(function(){function n(){$(".zone").each(function(){$(this).children(":not(.zoneName)").size()===0?$(this).addClass("empty-zone"):$(this).removeClass("empty-zone")})}$(".zone").sortable({placeholder:"sorting",handle:".sort-handle",tolerance:"pointer",connectWith:".zone",stop:function(n,t){var i,r;return t.item.removeAttr("style"),i=t.item.parent(),t.item.data("add")&&$.ajax({type:"POST",url:$("#append-widget-url").val(),dataType:"html",async:!1,data:{ID:t.item.data("id"),ZoneID:$("input.zoneId",this).val(),PageID:$("#pageId").val(),AssemblyName:t.item.data("assemblyname"),ServiceTypeName:t.item.data("servicetypename"),Position:1},success:function(n){t.item.replaceWith(n)}}),r=[],i.children(".widget-design").each(function(n,t){r.push({ID:$(t).data("widgetid"),ZoneId:$(".zoneId",i).val(),Position:n+1})}),$.ajax({type:"POST",url:$("#save-widget-zone-url").val(),dataType:"json",contentType:"application/json;charset=utf-8",async:!1,data:JSON.stringify(r),success:function(){}}),!0}});$(".templates ul li").draggable({helper:"clone",connectToSortable:".zone",appendTo:"body"});$(document).on("click",".delete",function(){var t=$(this);Easy.ShowMessageBox("提示","确定要删除该组件吗？",function(){$.post(t.data("url"),{ID:t.data("id")},function(t){t&&($("#widget_"+t).remove(),n())},"json")},!0,10)});$(document).on("click",".templates .tool-open",function(){$(this).parent().toggleClass("active")}).on("click",".templates .delete-template",function(){var n=$(this);Easy.ShowMessageBox("提示","确定要删除该模板吗？",function(){$.post(n.data("url"),{Id:n.data("id")},function(n){n&&$("#template_"+n).remove()},"json")},!0,10)});$(".helper").click(function(){$("#containers").toggleClass($(this).data("class"))});n();$(window).width()>1600&&$(".templates").addClass("active")});