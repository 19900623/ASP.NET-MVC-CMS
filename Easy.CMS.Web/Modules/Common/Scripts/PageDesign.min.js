$(function(){function n(){$(".zone").each(function(){$(this).children(":not(.zoneName)").size()===0?$(this).addClass("empty-zone"):$(this).removeClass("empty-zone")})}$(".zone").sortable({placeholder:"sorting",handle:".sort-handle",tolerance:"pointer",connectWith:".zone",stop:function(n,t){var r=t.item.parent(),i;return t.item.data("add")&&$.ajax({type:"POST",url:$("#append-widget-url").val(),dataType:"html",async:!1,data:{ID:t.item.data("id"),ZoneID:$("input.zoneId",this).val(),PageID:$("#pageId").val(),AssemblyName:t.item.data("assemblyname"),ServiceTypeName:t.item.data("servicetypename"),Position:1},success:function(n){t.item.replaceWith(n)}}),i=[],r.find(".widget-design").each(function(n,t){i.push({ID:$(t).data("widgetid"),ZoneId:$(".zoneId",r).val(),Position:n+1})}),$.ajax({type:"POST",url:$("#save-widget-zone-url").val(),dataType:"json",contentType:"application/json;charset=utf-8",async:!1,data:JSON.stringify(i),success:function(){}}),!0}});$(".templates ul li").draggable({helper:"clone",connectToSortable:".zone",appendTo:"body"});$(document).on("click",".delete",function(){var t=$(this);Easy.ShowMessageBox("\u63d0\u793a","\u786e\u5b9a\u8981\u5220\u9664\u8be5\u7ec4\u4ef6\u5417\uff1f",function(){$.post(t.data("url"),{ID:t.data("id")},function(t){t&&($("#widget_"+t).remove(),n())},"json")},!0,10)});$(document).on("click",".templates .tool-open",function(){$(this).parent().toggleClass("active")}).on("click",".templates .delete-template",function(){var n=$(this);Easy.ShowMessageBox("\u63d0\u793a","\u786e\u5b9a\u8981\u5220\u9664\u8be5\u6a21\u677f\u5417\uff1f",function(){$.post(n.data("url"),{Id:n.data("id")},function(n){n&&$("#template_"+n).remove()},"json")},!0,10)});$(".helper").click(function(){$("#containers").toggleClass($(this).data("class"))});n();$(window).width()>1600&&$(".templates").addClass("active")});